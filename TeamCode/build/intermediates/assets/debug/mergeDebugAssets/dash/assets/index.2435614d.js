var e=Object.assign;import{p as t,r as n,q as s,v as a,l as i,a as r,u as l,b as o,c,D as h,A as d,V as u,T as m,S as p,d as g,e as f,f as v,g as E,t as w,P as y}from"./vendor.24fb0d57.js";!function(e=".",t="__import__"){try{self[t]=new Function("u","return import(u)")}catch(n){const s=new URL(e,location),a=e=>{URL.revokeObjectURL(e.src),e.remove()};self[t]=e=>new Promise(((n,i)=>{const r=new URL(e,s);if(self[t].moduleMap[r])return n(self[t].moduleMap[r]);const l=new Blob([`import * as m from '${r}';`,`${t}.moduleMap['${r}']=m;`],{type:"text/javascript"}),o=Object.assign(document.createElement("script"),{type:"module",src:URL.createObjectURL(l),onerror(){i(new Error(`Failed to import: ${e}`)),a(o)},onload(){n(self[t].moduleMap[r]),a(o)}});document.head.appendChild(o)})),self[t].moduleMap={}}}("/dash/assets/");const b=({gridTemplate:e,children:t})=>n.createElement("div",{className:"tile-grid",style:{gridTemplate:e}},t);b.propTypes={gridTemplate:t.string.isRequired,children:t.node.isRequired};const _=({children:e,row:t,col:s})=>n.createElement("div",{className:"tile",style:{gridRow:t,gridColumn:s}},e);_.propTypes={children:t.node.isRequired,row:t.oneOfType([t.number,t.string]).isRequired,col:t.oneOfType([t.number,t.string]).isRequired};var x,C;(C=x||(x={}))[C.FIELD_VIEW=0]="FIELD_VIEW",C[C.GRAPH_VIEW=1]="GRAPH_VIEW",C[C.CONFIG_VIEW=2]="CONFIG_VIEW",C[C.TELEMETRY_VIEW=3]="TELEMETRY_VIEW",C[C.CAMERA_VIEW=4]="CAMERA_VIEW",C[C.OPMODE_VIEW=5]="OPMODE_VIEW",C[C.LOGGING_VIEW=6]="LOGGING_VIEW";const M=s.div.attrs((e=>({className:"flex flex-col h-full bg-white bg-opacity-75 overflow-hidden transition-shadow "+(e.isUnlocked?"shadow-md rounded-md select-none":"")})))``,S=s.h2.attrs((e=>({className:"text-xl w-full px-4 py-2 font-medium "+(e.isDraggable?"grab-handle":"")})))``,N=s.div.attrs((e=>({className:`px-4 ${e.className}`})))`
  flex: 1;
  overflow: auto;
`,O=s.div.attrs({className:"flex items-center mr-3 space-x-1"})``,k=s.div.attrs({className:"w-8 h-8 flex-center"})``,R=s.button.attrs((e=>({className:`icon-btn w-8 h-8 ${e.className}`})))``;class T extends n.Component{constructor(e){super(e),this.state={selected:this.props.selected||[],uuid:a()}}handleChange(e,t){e.target.checked?this.setState({selected:[...this.state.selected,t]},(()=>this.props.onChange(this.state.selected))):this.setState({selected:this.state.selected.filter((e=>t!==e))},(()=>this.props.onChange(this.state.selected)))}render(){return n.createElement("table",{className:"overflow-y-scroll"},n.createElement("tbody",null,this.props.arr.filter((e=>!this.props.exclude||-1===this.props.exclude.indexOf(e))).map((e=>n.createElement("tr",{key:e},n.createElement("td",null,n.createElement("input",{id:`multiple-checkbox-${this.state.uuid}-${e}`,className:"rounded",type:"checkbox",onChange:t=>this.handleChange(t,e),checked:-1!==this.state.selected.indexOf(e)})),n.createElement("td",null,n.createElement("label",{htmlFor:`multiple-checkbox-${this.state.uuid}-${e}`},e)))))))}}function L(e,t){const n=Math.round(e*t);return(n+.5*Math.sign(e-n))/t}T.propTypes={arr:t.arrayOf(t.string).isRequired,selected:t.arrayOf(t.string),exclude:t.arrayOf(t.string),onChange:t.func},CanvasRenderingContext2D.prototype.getScalingFactors=function(){let e;if("function"==typeof this.getTransform)e=this.getTransform();else{if(void 0===this.mozCurrentTransform)throw new Error("unable to find canvas transform");t=this.mozCurrentTransform,e=window.DOMMatrix.fromFloat64Array(Float64Array.from(t))}var t;const{a:n,b:s,c:a,d:i}=e;return{scalingX:Math.sqrt(n*n+a*a),scalingY:Math.sqrt(s*s+i*i)}},CanvasRenderingContext2D.prototype.fineMoveTo=function(e,t){const{scalingX:n,scalingY:s}=this.getScalingFactors();this.moveTo(L(e,n),L(t,s))},CanvasRenderingContext2D.prototype.fineLineTo=function(e,t){const{scalingX:n,scalingY:s}=this.getScalingFactors();this.lineTo(L(e,n),L(t,s))};const I={windowMs:5e3,colors:["#2979ff","#dd2c00","#4caf50","#7c4dff","#ffa000"],lineWidth:2,padding:15,keySpacing:4,keyLineLength:12,gridLineWidth:1,gridLineColor:"rgb(120, 120, 120)",fontSize:14,textColor:"rgb(50, 50, 50)",maxTicks:7};function D(e,t){const n=Math.floor(Math.log10(e)),s=e/Math.pow(10,n);let a;return a=t?s<1.5?1:s<3?2:s<7?5:10:s<=1?1:s<=2?2:s<=5?5:10,a*Math.pow(10,n)}function A(e,t,n){const s=D(t-e,!1),a=D(s/(n-1),!0);return{min:Math.floor(e/a)*a,max:(Math.floor(t/a)+1)*a,spacing:a}}function z(e,t){let n=t.length>3?t[2]-t[1]:t[1]-t[0];Math.abs(n)>1&&e!==Math.floor(e)&&(n=e-Math.floor(e));const s=Math.log10(Math.abs(n));let a="";if(0!==e){let t=-1*Math.floor(s);t=Math.max(Math.min(t,20),0),a=e.toFixed(t)}else a="0";return a}function V(e,t,n,s,a){return s+(a-s)/(n-t)*(e-t)}class P{constructor(e,t){this.canvas=e,this.ctx=e.getContext("2d"),this.options=i.cloneDeep(I),Object.assign(this.options,t||{}),this.hasGraphableContent=!1,this.clear()}clear(){this.time=[],this.datasets=[],this.lastSampleTime=0,this.hasGraphableContent=!1}addSample(e){if(0===this.lastSampleTime){this.lastSimTime=Date.now()+250,this.time.push(this.lastSimTime);let t=0;for(let n=0;n<e.length;n++)"time"===e[n].name?this.lastSampleTime=e[n].value:(this.datasets.push({name:e[n].name,data:[e[n].value],color:this.options.colors[t%this.options.colors.length]}),t++)}else for(let t=0;t<e.length;t++)if("time"===e[t].name)this.lastSimTime+=e[t].value-this.lastSampleTime,this.time.push(this.lastSimTime),this.lastSampleTime=e[t].value;else for(let n=0;n<this.datasets.length;n++)e[t].name===this.datasets[n].name&&this.datasets[n].data.push(e[t].value)}getAxis(){let e=Number.MAX_VALUE,t=Number.MIN_VALUE;for(let n=0;n<this.datasets.length;n++)for(let s=0;s<this.datasets[n].data.length;s++){const a=this.datasets[n].data[s];a>t&&(t=a),a<e&&(e=a)}return Math.abs(e-t)<1e-6?A(e-1,t+1,this.options.maxTicks):A(e,t,this.options.maxTicks)}render(){const e=this.options;this.canvas.width=this.canvas.width,this.ctx.scale(devicePixelRatio,devicePixelRatio),this.ctx.font=`${e.fontSize}px "Roboto", sans-serif`,this.ctx.textBaseline="middle",this.ctx.textAlign="left",this.ctx.lineWidth=e.lineWidth/devicePixelRatio;const t=this.canvas.width/devicePixelRatio,n=this.canvas.height/devicePixelRatio;this.ctx.fillStyle="#fff",this.ctx.fillRect(0,0,t,n);const s=this.renderKey(0,0,t);this.renderGraph(0,s,t,n-s)}renderKey(e,t,n){const s=this.options;this.ctx.save();const a=this.datasets.length,i=a*s.fontSize+(a-1)*s.keySpacing;for(let r=0;r<a;r++){const a=t+r*(s.fontSize+s.keySpacing)+s.fontSize/2,i=this.datasets[r].name,l=this.datasets[r].color,o=e+(n-(this.ctx.measureText(i).width+s.keyLineLength+s.keySpacing))/2;this.ctx.strokeStyle=l,this.ctx.beginPath(),this.ctx.fineMoveTo(o,a),this.ctx.fineLineTo(o+s.keyLineLength,a),this.ctx.stroke(),this.ctx.fillStyle=s.textColor,this.ctx.fillText(i,o+s.keyLineLength+s.keySpacing,a)}return this.ctx.restore(),i}renderGraph(e,t,n,s){const a=this.options;if(0===this.datasets.length||0===this.datasets[0].data.length)return void(this.hasGraphableContent=!1);this.hasGraphableContent=!0;const i=Date.now();for(;i-this.time[0]>a.windowMs+250;){this.time.shift();for(let e=0;e<this.datasets.length;e++)this.datasets[e].data.shift()}const r=s-2*a.padding,l=this.getAxis(),o=function(e){const t=[];for(let s=e.min;s<=e.max;s+=e.spacing)t.push(s);const n=[];for(let s=0;s<t.length;s++){const e=z(t[s],t);n.push(e)}return n}(l),c=this.renderAxisLabels(e+a.padding,t+a.padding,r,o),h=n-c-3*a.padding;this.renderGridLines(e+c+2*a.padding,t+a.padding,h,r,5,o.length),this.renderGraphLines(e+c+2*a.padding,t+a.padding,h,r,l)}renderAxisLabels(e,t,n,s){this.ctx.save();let a=0;for(let r=0;r<s.length;r++){const e=this.ctx.measureText(s[r]).width;e>a&&(a=e)}this.ctx.textAlign="right",this.ctx.fillStyle=this.options.textColor;const i=n/(s.length-1);e+=a;for(let r=0;r<s.length;r++)this.ctx.fillText(s[r],e,t+(s.length-r-1)*i);return this.ctx.restore(),a}renderGridLines(e,t,n,s,a,i){this.ctx.save(),this.ctx.strokeStyle=this.options.gridLineColor,this.ctx.lineWidth=this.options.gridLineWidth/devicePixelRatio;const r=n/(a-1),l=s/(i-1);for(let o=0;o<a;o++){const n=e+r*o;this.ctx.beginPath(),this.ctx.fineMoveTo(n,t),this.ctx.fineLineTo(n,t+s),this.ctx.stroke()}for(let o=0;o<i;o++){const s=t+l*o;this.ctx.beginPath(),this.ctx.fineMoveTo(e,s),this.ctx.fineLineTo(e+n,s),this.ctx.stroke()}this.ctx.restore()}renderGraphLines(e,t,n,s,a){const i=this.options,r=Date.now();this.ctx.lineWidth=i.lineWidth,this.ctx.save(),this.ctx.translate(e,t),this.ctx.rect(0,0,n,s),this.ctx.clip(),this.ctx.beginPath();for(let l=0;l<this.datasets.length;l++){const e=this.datasets[l];this.ctx.beginPath(),this.ctx.strokeStyle=e.color,this.ctx.fineMoveTo(V(this.time[0]-r+i.windowMs,0,i.windowMs,0,n),V(e.data[0],a.min,a.max,s,0));for(let t=1;t<e.data.length;t++)this.ctx.fineLineTo(V(this.time[t]-r+i.windowMs,0,i.windowMs,0,n),V(e.data[t],a.min,a.max,s,0));this.ctx.stroke()}this.ctx.restore()}}class H extends n.Component{constructor(e){super(e),this.resize=this.resize.bind(this),this.containerRef=n.createRef(),this.resizeObserver=new ResizeObserver((e=>{for(let t of e)t.target===this.containerRef.current&&this.resize()}))}componentDidMount(){this.resize(),this.resizeObserver.observe(this.containerRef.current)}componentWillUnmount(){this.resizeObserver.disconnect()}resize(){var e,t;const n=this.props.innerRef.current;n.width=this.containerRef.current.clientWidth*devicePixelRatio,n.height=this.containerRef.current.clientHeight*devicePixelRatio,n.style.width=n.width/devicePixelRatio+"px",n.style.height=n.height/devicePixelRatio+"px",null==(t=(e=this.props).onResize)||t.call(e)}render(){return n.createElement("div",{style:{width:"100%",height:this.props.containerHeight},ref:this.containerRef},n.createElement("canvas",{ref:this.props.innerRef}))}}H.defaultProps={containerHeight:"100%"},H.propTypes={innerRef:t.any.isRequired,onResize:t.func,containerHeight:t.string};const U=n.forwardRef(((t,s)=>n.createElement(H,e({innerRef:s},t))));U.displayName="AutoFitCanvas";class G extends n.Component{constructor(e){super(e),this.canvasRef=n.createRef(),this.renderGraph=this.renderGraph.bind(this)}componentDidMount(){this.graph=new P(this.canvasRef.current,this.props.options),this.renderGraph()}componentWillUnmount(){this.requestId&&cancelAnimationFrame(this.requestId)}componentDidUpdate(e){this.props.data.filter((e=>e.length>1)).forEach((e=>this.graph.addSample(e))),e.paused!==this.props.paused&&(this.requestId&&cancelAnimationFrame(this.requestId),this.props.paused||this.renderGraph())}renderGraph(){!this.props.paused&&this.graph&&(this.graph.render(),this.requestId=requestAnimationFrame(this.renderGraph))}render(){var e,t;return n.createElement("div",{className:"h-full flex-center"},n.createElement("div",{className:(null!==this.graph&&(null==(e=this.graph)?void 0:e.hasGraphableContent)?"":"hidden")+" w-full h-full"},n.createElement(U,{ref:this.canvasRef})),n.createElement("div",{className:"absolute top-0 left-0 w-full h-full flex-center pointer-events-none"},(null===this.graph||!(null==(t=this.graph)?void 0:t.hasGraphableContent))&&n.createElement("p",{className:"text-center"},"No content to graph")))}}G.propTypes={data:t.arrayOf(t.arrayOf(t.shape({name:t.string,value:t.number}))).isRequired,options:t.object,paused:t.bool};class W extends n.Component{constructor(e){super(e),this.inputRef=n.createRef(),this.handleChange=this.handleChange.bind(this),this.handleKeyDown=this.handleKeyDown.bind(this),this.state={value:e.value}}componentDidUpdate(){this.inputRef.current.setCustomValidity(this.props.valid?"":"Invalid input"),this.props.value!==this.props.validate(this.state.value).value&&this.setState({value:this.props.value})}handleChange(e){this.setState({value:e.target.value});const t=this.props.validate(e.target.value);t&&this.props.onChange(t)}handleKeyDown(e){this.props.onSave&&13===e.keyCode&&this.props.onSave()}render(){return n.createElement("input",{className:"bg-gray-100 rounded border border-gray-200 px-3 py-1 "+(this.props.valid?"":"border-red-500 focus:ring-red-500 focus:border-red-500"),ref:this.inputRef,type:"text",size:15,value:this.state.value,onChange:this.handleChange,onKeyDown:this.handleKeyDown})}}function $(t){return n.createElement("svg",e({fill:"#000000",height:48,viewBox:"0 0 24 24",width:48,xmlns:"http://www.w3.org/2000/svg"},t),n.createElement("path",{fill:"currentColor",d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"}),n.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}))}function F(t){return n.createElement("svg",e({fill:"currentColor",height:24,viewBox:"0 0 24 24",width:24,xmlns:"http://www.w3.org/2000/svg"},t),n.createElement("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),n.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}))}function B(t){return n.createElement("svg",e({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"black",width:"18px",height:"18px"},t),n.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}),n.createElement("path",{d:"M8 5v14l11-7z"}))}function q(t){return n.createElement("svg",e({xmlns:"http://www.w3.org/2000/svg",height:24,viewBox:"0 0 24 24",width:24},t),n.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}),n.createElement("path",{d:"M6 19h4V5H6v14zm8-14v14h4V5h-4z"}))}W.propTypes={value:t.any.isRequired,valid:t.bool.isRequired,validate:t.func.isRequired,onChange:t.func.isRequired,onSave:t.func};const j=e=>isNaN(Number(e))||""===e?{value:e,valid:!1}:{value:parseFloat(e),valid:!0},Y=e=>/^-?\d+$/.test(e)?{value:parseInt(e,10),valid:!0}:{value:e,valid:!1},K=e=>({value:e,valid:!0}),X=r((e=>({telemetry:e.telemetry})));class J extends n.Component{constructor(e){super(e),this.state={graphing:!1,paused:!1,keys:[],windowMs:{value:I.windowMs,valid:!0}},this.containerRef=n.createRef(),this.start=this.start.bind(this),this.stop=this.stop.bind(this),this.play=this.play.bind(this),this.pause=this.pause.bind(this),this.handleDocumentKeydown=this.handleDocumentKeydown.bind(this)}componentDidMount(){this.containerRef.current&&this.containerRef.current.addEventListener("keydown",this.handleDocumentKeydown)}componentWillUnmount(){this.containerRef.current&&this.containerRef.current.removeEventListener("keydown",this.handleDocumentKeydown)}handleDocumentKeydown(t){"Space"!==t.code&&"k"!==t.key||this.setState(e(e({},this.state),{paused:!this.state.paused}))}start(){this.setState(e(e({},this.state),{graphing:!0,paused:!1}))}stop(){this.setState(e(e({},this.state),{graphing:!1}))}pause(){this.setState(e(e({},this.state),{paused:!0}))}play(){this.setState(e(e({},this.state),{paused:!1}))}render(){const{telemetry:e}=this.props,t=e[e.length-1],s=Object.keys(t.data).filter((e=>!isNaN(parseFloat(t.data[e])))),a=!this.state.graphing&&0===s.length,i=this.state.graphing&&0===this.state.keys.length,r=a||i,l=e.map((e=>[{name:"time",value:e.timestamp},...Object.keys(e.data).filter((e=>this.state.keys.includes(e))).map((t=>({name:t,value:parseFloat(e.data[t])})))]));return n.createElement(M,{className:"flex flex-col overflow-auto",isUnlocked:this.props.isUnlocked,ref:this.containerRef,tabIndex:0},n.createElement("div",{className:"flex"},n.createElement(S,{isDraggable:this.props.isDraggable},"Graph"),n.createElement(O,null,this.state.graphing&&0!==this.state.keys.length&&n.createElement(R,{className:"w-8 h-8 icon-btn"},this.state.paused?n.createElement(B,{className:"w-6 h-6",onClick:this.play}):n.createElement(q,{className:"w-6 h-6",onClick:this.pause})),n.createElement(R,null,this.state.graphing?n.createElement(F,{className:"w-6 h-6 text-black",onClick:this.stop}):n.createElement($,{className:"w-6 h-6",onClick:this.start})))),n.createElement(N,{className:r?"flex-center":""},this.state.graphing?i?n.createElement("p",{className:"justify-self-center text-center"},"No telemetry selected to graph"):n.createElement(G,{data:l,options:{windowMs:this.state.windowMs.valid?this.state.windowMs.value:I.windowMs},paused:this.state.paused}):a?n.createElement("p",{className:"justify-self-center text-center"},"Send number-valued telemetry data to graph them over time"):n.createElement(n.Fragment,null,n.createElement("p",{className:"my-2 text-center"},"Press the upper-right button to graph selected keys over time"),n.createElement("h3",{className:"mt-6 font-medium"},"Telemetry to graph:"),n.createElement("div",{className:"ml-3"},n.createElement(T,{arr:s,onChange:e=>this.setState({keys:e}),selected:this.state.keys})),n.createElement("div",{className:"mt-4"},n.createElement("div",{className:"flex justify-between items-center"},n.createElement("h3",{className:"font-medium"},"Options:")),n.createElement("div",{className:"ml-3"},n.createElement("table",null,n.createElement("tbody",null,n.createElement("tr",null,n.createElement("td",null,"Window (ms)"),n.createElement("td",null,n.createElement(W,{value:this.state.windowMs.value,valid:this.state.windowMs.valid,validate:Y,onChange:({value:e,valid:t})=>this.setState({windowMs:{value:e,valid:t}})}))))))))))}}var Z=X(J);const Q=new Image,ee=[];let te=!1;Q.onload=function(){te=!0,ee.forEach((e=>e.render()))},Q.src="/dash/assets/field.bf55e204.png";const ne={padding:15,alpha:.25,fieldSize:144,splineSamples:250,gridLineWidth:1,gridLineColor:"rgb(120, 120, 120)"};class se{constructor(e,t){this.canvas=e,this.ctx=e.getContext("2d"),this.options=i.cloneDeep(ne),Object.assign(this.options,t||{}),this.overlay={ops:[]}}setOverlay(e){this.overlay=e}render(){this.canvas.width=this.canvas.width,this.ctx.scale(devicePixelRatio,devicePixelRatio);const e=this.canvas.width/devicePixelRatio,t=this.canvas.height/devicePixelRatio,n=(e<t?e:t)-2*this.options.padding;te||-1!==ee.indexOf(this)||ee.push(this),this.renderField((e-n)/2,(t-n)/2,n,n)}renderField(e,t,n,s){this.ctx.save(),this.ctx.globalAlpha=this.options.alpha,this.ctx.drawImage(Q,e,t,n,s),this.ctx.restore(),this.renderGridLines(e,t,n,s,7,7),this.renderOverlay(e,t,n,s)}renderGridLines(e,t,n,s,a,i){this.ctx.save(),this.ctx.strokeStyle=this.options.gridLineColor,this.ctx.lineWidth=this.options.gridLineWidth/devicePixelRatio;const r=n/(a-1),l=s/(i-1);for(let o=0;o<a;o++){const n=e+r*o;this.ctx.beginPath(),this.ctx.fineMoveTo(n,t),this.ctx.fineLineTo(n,t+s),this.ctx.stroke()}for(let o=0;o<i;o++){const s=t+l*o;this.ctx.beginPath(),this.ctx.fineMoveTo(e,s),this.ctx.fineLineTo(e+n,s),this.ctx.stroke()}this.ctx.restore()}renderOverlay(e,t,n,s){const a=this.options;this.ctx.save(),this.ctx.translate(e+n/2,t+s/2),this.ctx.scale(n/a.fieldSize,-s/a.fieldSize),this.ctx.rotate(Math.PI/2),this.ctx.lineCap="butt",this.overlay.ops.forEach((e=>{switch(e.type){case"fill":this.ctx.fillStyle=e.color;break;case"stroke":this.ctx.strokeStyle=e.color;break;case"strokeWidth":this.ctx.lineWidth=e.width;break;case"circle":this.ctx.beginPath(),this.ctx.arc(e.x,e.y,e.radius,0,2*Math.PI),e.stroke?this.ctx.stroke():this.ctx.fill();break;case"polygon":{this.ctx.beginPath();const{xPoints:t,yPoints:n,stroke:s}=e;this.ctx.fineMoveTo(t[0],n[0]);for(let e=1;e<t.length;e++)this.ctx.fineLineTo(t[e],n[e]);this.ctx.closePath(),s?this.ctx.stroke():this.ctx.fill();break}case"polyline":{this.ctx.beginPath();const{xPoints:t,yPoints:n}=e;this.ctx.fineMoveTo(t[0],n[0]);for(let e=1;e<t.length;e++)this.ctx.fineLineTo(t[e],n[e]);this.ctx.stroke();break}case"spline":{this.ctx.beginPath();const{ax:t,bx:n,cx:s,dx:i,ex:r,fx:l,ay:o,by:c,cy:h,dy:d,ey:u,fy:m}=e;this.ctx.fineMoveTo(l,m);for(let e=0;e<=a.splineSamples;e++){const p=e/a.splineSamples,g=(t*p+n)*(p*p*p*p)+s*(p*p*p)+i*(p*p)+r*p+l,f=(o*p+c)*(p*p*p*p)+h*(p*p*p)+d*(p*p)+u*p+m;this.ctx.lineTo(g,f)}this.ctx.stroke();break}default:throw new Error(`unknown operation: ${e.type}`)}})),this.ctx.restore()}}class ae extends n.Component{constructor(e){super(e),this.canvasRef=n.createRef(),this.renderField=this.renderField.bind(this)}componentDidMount(){this.field=new se(this.canvasRef.current),this.renderField()}componentDidUpdate(){this.field.setOverlay(this.props.overlay),this.renderField()}renderField(){this.field&&this.field.render()}render(){return n.createElement(M,{isUnlocked:this.props.isUnlocked},n.createElement(S,{isDraggable:this.props.isDraggable},"Field"),n.createElement(U,{ref:this.canvasRef,onResize:this.renderField,containerHeight:"calc(100% - 3em)"}))}}ae.propTypes={overlay:t.shape({ops:t.array.isRequired}).isRequired,isDraggable:t.bool,isUnlocked:t.bool};var ie=r((({telemetry:e})=>({overlay:e[e.length-1].fieldOverlay})))(ae);const re=({value:e,onChange:t,onSave:s})=>n.createElement("span",{className:"flex items-center"},n.createElement("input",{className:"mr-4 rounded",type:"checkbox",checked:e,onChange:e=>t({value:e.target.checked,valid:!0})}),n.createElement("button",{className:"bg-gray-100 px-2 rounded border border-gray-200",onClick:s},"Save"));re.propTypes={value:t.bool.isRequired,onChange:t.func.isRequired,onSave:t.func.isRequired};const le=({value:e,enumValues:t,onChange:s,onSave:a})=>n.createElement("span",null,n.createElement("select",{className:"valid mr-4 rounded py-0",value:e,onChange:e=>s({value:e.target.value,valid:!0})},t.map((e=>n.createElement("option",{key:e,value:e},e)))),n.createElement("button",{className:"bg-gray-100 px-2 rounded border border-gray-200",onClick:a},"Save"));le.propTypes={value:t.string.isRequired,enumValues:t.arrayOf(t.string).isRequired,onChange:t.func.isRequired,onSave:t.func.isRequired};const oe={BOOLEAN:"boolean",INT:"int",DOUBLE:"double",STRING:"string",ENUM:"enum",CUSTOM:"custom"};class ce extends n.Component{render(){const{type:e,name:t,value:s,enumClass:a,enumValues:i,modified:r,valid:l,onChange:o,onSave:c}=this.props,h=({valid:t,value:n})=>{o({__type:e,__value:n,__valid:t})},d=()=>{l&&r&&c({__type:e,__value:s,__valid:!0,__enumClass:a})};let u;switch(e){case oe.INT:u=n.createElement(W,{value:s,valid:l,validate:Y,onChange:h,onSave:d});break;case oe.DOUBLE:u=n.createElement(W,{value:s,valid:l,validate:j,onChange:h,onSave:d});break;case oe.STRING:u=n.createElement(W,{value:s,valid:l,validate:K,onChange:h,onSave:d});break;case oe.BOOLEAN:u=n.createElement(re,{value:s,onChange:h,onSave:d});break;case oe.ENUM:u=n.createElement(le,{value:s,enumValues:i,onChange:h,onSave:d});break;default:u=n.createElement("p",null,"Unknown option type: ",e)}return n.createElement("tr",null,n.createElement("td",null,n.createElement("span",{style:r?{userSelect:"auto",opacity:1}:{userSelect:"none",opacity:0}},"*"),t),n.createElement("td",null,u))}}function he(t){return n.createElement("svg",e({fill:"#000000",height:24,viewBox:"0 0 24 24",width:24,xmlns:"http://www.w3.org/2000/svg"},t),n.createElement("path",{d:"M16.59 8.59L12 13.17 7.41 8.59 6 10l6 6 6-6z"}),n.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}))}ce.propTypes={type:t.oneOf(Object.values(oe)).isRequired,name:t.string.isRequired,value:t.any.isRequired,modified:t.bool.isRequired,valid:t.bool.isRequired,enumClass:t.string,enumValues:t.arrayOf(t.string),onChange:t.func.isRequired,onSave:t.func.isRequired};class de extends n.Component{constructor(e){super(e),this.state={expanded:!1},this.toggleVisibility=this.toggleVisibility.bind(this)}toggleVisibility(){this.setState({expanded:!this.state.expanded})}render(){const{name:e,value:t}=this.props,s=Object.keys(t);s.sort();const a=s.map((e=>{const s=t[e],a=t=>{this.props.onChange({__type:oe.CUSTOM,__value:{[e]:t}})},i=t=>{this.props.onSave({__type:oe.CUSTOM,__value:{[e]:t}})};return s.__type===oe.CUSTOM?n.createElement(de,{key:e,name:e,value:s.__value,onChange:a,onSave:i}):n.createElement(ce,{key:e,type:s.__type,name:e,value:s.__newValue,valid:s.__valid,enumClass:s.__enumClass,enumValues:s.__enumValues,modified:s.__modified,onChange:a,onSave:i})}));return n.createElement("tr",null,n.createElement("td",null,n.createElement("div",{className:"option-header py-1 cursor-pointer",onClick:this.toggleVisibility},n.createElement("div",{className:"w-7 h-7 mr-2 bg-gray-100 flex-center rounded-full border border-gray-200 hover:border-gray-400 hover:bg-gray-200\n                          transition transform "+(this.state.expanded?"":"-rotate-90")},n.createElement(he,{className:"w-6 h-6"})),n.createElement("div",{className:"flex justify-between items-center"},n.createElement("h3",{className:"text-lg select-none"},e))),this.state.expanded&&n.createElement("table",null,n.createElement("tbody",null,a))))}}function ue(t){return n.createElement("svg",e({fill:"#000000",height:48,viewBox:"0 0 24 24",width:48,xmlns:"http://www.w3.org/2000/svg"},t),n.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}),n.createElement("path",{d:"M17 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V7l-4-4zm-5 16c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3zm3-10H5V5h10v4z"}))}function me(t){return n.createElement("svg",e({fill:"#000000",height:48,viewBox:"0 0 24 24",width:48,xmlns:"http://www.w3.org/2000/svg"},t),n.createElement("path",{d:"M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"}),n.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}))}de.propTypes={name:t.string.isRequired,value:t.object.isRequired,onChange:t.func.isRequired,onSave:t.func.isRequired};const pe=e=>{if(e.__type===oe.CUSTOM){const t={__type:oe.CUSTOM,__value:{}};for(const n of Object.keys(e.__value)){const s=pe(e.__value[n]);s&&(t.__value[n]=s)}if(!i.isEmpty(t.__value))return t}else if(e.__modified&&e.__valid)return{__type:e.__type,__value:e.__newValue,__valid:!0,__enumClass:e.__enumClass}},ge=({isDraggable:e=!1,isUnlocked:t=!1})=>{const s=l(),a=o((e=>e.config.configRoot)),i=e=>s((e=>({type:"SAVE_CONFIG",configDiff:e}))(e)),r=Object.keys(a.__value||{});return r.sort(),n.createElement(M,{isUnlocked:t},n.createElement("div",{className:"flex"},n.createElement(S,{isDraggable:e},"Configuration"),n.createElement(O,null,n.createElement(R,{onClick:()=>{return i(null!=(e=pe(a))?e:{__type:oe.CUSTOM,__value:{}});var e}},n.createElement(ue,{className:"w-6 h-6"})),n.createElement(R,{onClick:()=>s({type:"REFRESH_CONFIG"})},n.createElement(me,{className:"w-6 h-6"})))),n.createElement(N,null,n.createElement("table",{className:"block h-full"},n.createElement("tbody",null,r.map((e=>n.createElement(de,{key:e,name:e,value:a.__value[e].__value||{},onChange:t=>{s((e=>({type:"UPDATE_CONFIG",configDiff:e}))({__type:oe.CUSTOM,__value:{[e]:t}}))},onSave:t=>{i({__type:oe.CUSTOM,__value:{[e]:t}})}})))))))},fe=({isDraggable:e=!1,isUnlocked:t=!1})=>{const s=o((e=>e.telemetry)),a=s[s.length-1],i=Object.keys(a.data).map((e=>n.createElement("span",{key:e},e,": ",a.data[e],n.createElement("br",null)))),r=a.log.map(((e,t)=>n.createElement("span",{key:t},e,n.createElement("br",null))));return n.createElement(M,{isUnlocked:t},n.createElement(S,{isDraggable:e},"Telemetry"),n.createElement(N,null,n.createElement("p",null,i),n.createElement("p",null,r)))};class ve extends n.Component{constructor(e){super(e),this.canvasRef=n.createRef(),this.renderImage=this.renderImage.bind(this),this.image=new Image,this.image.onload=this.renderImage,this.state={rotation:0}}componentDidMount(){this.ctx=this.canvasRef.current.getContext("2d")}componentDidUpdate(){this.image.src=`data:image/jpeg;base64,${this.props.imageStr}`}renderImage(){if(this.ctx&&this.props.imageStr.length>0){const e=this.canvasRef.current;e.width=e.width;const t=e.width,n=e.height,s=Math.min(devicePixelRatio,(this.state.rotation%2==0?n:t)/this.image.height,(this.state.rotation%2==0?t:n)/this.image.width);this.ctx.translate(t/2,n/2),this.ctx.rotate(this.state.rotation*Math.PI/2),this.ctx.scale(s,s),this.ctx.drawImage(this.image,-this.image.width/2,-this.image.height/2,this.image.width,this.image.height)}}render(){return n.createElement(M,{isUnlocked:this.props.isUnlocked},n.createElement("div",{className:"flex"},n.createElement(S,{isDraggable:this.props.isDraggable},"Camera"),n.createElement(O,null,n.createElement(R,null,n.createElement(me,{className:"w-6 h-6",onClick:()=>this.setState({rotation:(this.state.rotation+1)%4})})))),n.createElement(N,null,n.createElement("div",{style:{height:"100%",minHeight:"10rem"}},n.createElement(U,{ref:this.canvasRef,onResize:this.renderImage}))))}}ve.propTypes={imageStr:t.string.isRequired,isDraggable:t.bool,isUnlocked:t.bool};var Ee=r((({camera:e})=>({imageStr:e.imageStr})))(ve);const we="INIT",ye="RUNNING",be="STOPPED";function _e(t){return n.createElement("svg",e({fill:"#000000",height:48,viewBox:"0 0 24 24",width:48,xmlns:"http://www.w3.org/2000/svg"},t),n.createElement("path",{d:"M7.97,16L5,19C4.67,19.3 4.23,19.5 3.75,19.5A1.75,1.75 0 0,1 2,17.75V17.5L3,10.12C3.21,7.81 5.14,6 7.5,6H16.5C18.86,6 20.79,7.81 21,10.12L22,17.5V17.75A1.75,1.75 0 0,1 20.25,19.5C19.77,19.5 19.33,19.3 19,19L16.03,16H7.97M7,8V10H5V11H7V13H8V11H10V10H8V8H7M16.5,8A0.75,0.75 0 0,0 15.75,8.75A0.75,0.75 0 0,0 16.5,9.5A0.75,0.75 0 0,0 17.25,8.75A0.75,0.75 0 0,0 16.5,8M14.75,9.75A0.75,0.75 0 0,0 14,10.5A0.75,0.75 0 0,0 14.75,11.25A0.75,0.75 0 0,0 15.5,10.5A0.75,0.75 0 0,0 14.75,9.75M18.25,9.75A0.75,0.75 0 0,0 17.5,10.5A0.75,0.75 0 0,0 18.25,11.25A0.75,0.75 0 0,0 19,10.5A0.75,0.75 0 0,0 18.25,9.75M16.5,11.5A0.75,0.75 0 0,0 15.75,12.25A0.75,0.75 0 0,0 16.5,13A0.75,0.75 0 0,0 17.25,12.25A0.75,0.75 0 0,0 16.5,11.5Z"}))}const xe=r((({status:t,gamepad:n})=>e(e({},t),n)),{initOpMode:e=>(e=>({type:"INIT_OP_MODE",opModeName:e}))(e),startOpMode:()=>({type:"START_OP_MODE"}),stopOpMode:()=>({type:"STOP_OP_MODE"})}),Ce=s.button.attrs((e=>({className:`ml-2 py-1 px-3 border rounded-md shadow-md ${e.className}`})))``;class Me extends n.Component{constructor(e){super(e),this.state={selectedOpMode:""},this.onChange=this.onChange.bind(this)}static getDerivedStateFromProps(e,t){return"$Stop$Robot$"!==e.activeOpMode?{selectedOpMode:e.activeOpMode}:""===t.selectedOpMode||-1===e.opModeList.indexOf(t.selectedOpMode)?{selectedOpMode:e.opModeList[0]||""}:{}}onChange(e){this.setState({selectedOpMode:e.target.value})}renderInitButton(){return n.createElement(Ce,{className:"bg-blue-200 border-blue-300",onClick:()=>this.props.initOpMode(this.state.selectedOpMode)},"Init")}renderStartButton(){return n.createElement(Ce,{className:"bg-green-200 border-green-300",onClick:()=>this.props.startOpMode()},"Start")}renderStopButton(){return n.createElement(Ce,{className:"bg-red-200 border-red-300",onClick:()=>this.props.stopOpMode()},"Stop")}renderButtons(){const{activeOpMode:e,activeOpModeStatus:t,opModeList:s}=this.props;return 0===s.length?null:"$Stop$Robot$"===e?this.renderInitButton():t===we?n.createElement("span",null,this.renderStartButton(),this.renderStopButton()):t===ye?this.renderStopButton():t===be?null:n.createElement("p",null,"Unknown op mode status: ",t)}render(){const{available:e,activeOpMode:t,opModeList:s,warningMessage:a,errorMessage:i}=this.props,{gamepad1Connected:r,gamepad2Connected:l}=this.props;return e?n.createElement(M,{isUnlocked:this.props.isUnlocked},n.createElement("div",{className:"flex"},n.createElement(S,{isDraggable:this.props.isDraggable},"Op Mode"),n.createElement(O,null,n.createElement(k,null,n.createElement(_e,{className:"w-6 h-6",style:{opacity:r?1:.3}})),n.createElement(k,null,n.createElement(_e,{className:"w-6 h-6",style:{opacity:l?1:.3}})))),n.createElement(N,null,n.createElement("select",{className:"bg-gray-200 rounded p-1 pr-6 m-1 mr-2 border border-gray-300 shadow-md disabled:shadow-none disabled:text-gray-600 transition",value:this.state.selectedOpMode,disabled:"$Stop$Robot$"!==t||0===s.length,onChange:this.onChange},0===s.length?n.createElement("option",null,"Loading..."):s.sort().map((e=>n.createElement("option",{key:e},e)))),this.renderButtons(),""!==i&&n.createElement("p",{className:"error mt-5 ml-1"},"Error: ",i),""!==a&&n.createElement("p",{className:"warning mt-5 ml-1"},"Warning: ",a))):n.createElement(M,{isUnlocked:this.props.isUnlocked},n.createElement(S,{isDraggable:this.props.isDraggable},"Op Mode"),n.createElement(N,{className:"flex-center"},n.createElement("h3",{className:"text-md text-center"},"Op mode controls have not initialized")))}}var Se=xe(Me);const Ne=s.div`
  position: fixed;
  bottom: ${({bottom:e,height:t,isShowing:n})=>n?e:`calc(${e} - (${t} * 2)) `};
  right: ${({right:e})=>e};

  transition: bottom 300ms ease;
`,Oe=s.button.attrs((({customClassName:e})=>({className:`focus:outline-none focus:ring-2 focus:ring-opacity-50 flex-center transition ${e}`})))`
  width: ${({width:e})=>e};
  height: ${({height:e})=>e};

  border-radius: 50%;

  padding: 0;

  border: none;
  outline: none !important;

  transition: 300ms ease;
`,ke=s.img`
  width: 1.95em;
  color: white;
`,Re=t=>n.createElement(Ne,e({},t),n.createElement(Oe,e(e({},t),{onClick:t.clickEvent}),n.createElement(ke,{src:t.icon})),n.Children.map(t.children,(e=>n.cloneElement(e,{isOpen:t.isOpen}))));function Te(e,t){const[s,a]=n.useState(!1),i=n.useRef(!1),r=n.useRef(null);return n.useEffect((()=>{var n,s,l,o;const c=()=>{i.current=!0,null!==r.current&&clearInterval(r.current),r.current=setTimeout((()=>{i.current?a(!0):a(!1)}),1e3*e)},h=()=>{i.current=!1,a(!1)};null!==t.current&&(null==(n=t.current)||n.removeEventListener("mouseenter",c),null==(s=t.current)||s.removeEventListener("focusin",c),null==(l=t.current)||l.removeEventListener("mouseleave",h),null==(o=t.current)||o.removeEventListener("focusout",h)),t.current&&(t.current.addEventListener("mouseenter",c),t.current.addEventListener("focusin",c),t.current.addEventListener("mouseleave",h),t.current.addEventListener("focusout",h))}),[e,t]),n.useEffect((()=>()=>{null!==r.current&&clearTimeout(r.current)}),[]),s}Re.defaultProps={width:"4em",height:"4em",bottom:"2em",right:"2em"};const Le=s.span.attrs((e=>({className:"fixed rounded-md px-3 py-1 w-max bg-gray-800 bg-opacity-80 text-white text-sm pointer-events-none transform transition "+(e.isShowing?"-translate-y-11 opacity-100":"-translate-y-9 opacity-0")})))`
  top: ${e=>e.top};
  left: ${e=>e.left};
`,Ie=({children:e,hoverRef:t,isShowing:s})=>{var a,i,r,l,o,h,d;const u=n.useRef(null);return c.createPortal(n.createElement(Le,{ref:u,isShowing:s,top:`${null==(a=t.current)?void 0:a.getBoundingClientRect().top}px`,left:(null!=(r=null==(i=t.current)?void 0:i.getBoundingClientRect().left)?r:0)+(null!=(o=null==(l=t.current)?void 0:l.clientWidth)?o:0)/2-(null!=(d=null==(h=u.current)?void 0:h.clientWidth)?d:0)/2+"px"},e),document.body)},De=s.button.attrs((({customClass:e})=>({className:`top-1/2 left-1/2 rounded-full outline-none focus:outline-none relative flex-center transition ${e}`})))`
  /* Not sure why but removing this and replacing it with the tailwind absolute class breaks the button */
  position: absolute;

  transform: ${({angle:e,openMargin:t,isOpen:n})=>`translate(${`calc(${n?Math.cos(e):0} * ${t} - 50%)`}, ${`calc(${n?Math.sin(e):0} * ${t} - 50%)`})`};

  z-index: -1;
`,Ae=s.div`
  transition: transform 300ms ease;

  transform: ${({fineAdjustIconX:e,fineAdjustIconY:t,isOpen:n})=>`translate(${e}, ${t}) rotate(${n?0:90}deg)`};
`,ze=t=>{const s=n.useRef(null),a=Te(.5,s);return n.createElement(De,e(e({},t),{onClick:t.clickEvent,ref:s}),n.createElement(Ae,e({},t),t.children),""!==t.toolTipText&&n.createElement(Ie,{isShowing:a,hoverRef:s},t.toolTipText))};function Ve(t){return n.createElement("svg",e({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"white",width:"18px",height:"18px"},t),n.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}),n.createElement("circle",{cx:12,cy:12,r:3.2}),n.createElement("path",{d:"M9 2L7.17 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2h-3.17L15 2H9zm3 15c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5z"}))}function Pe(t){return n.createElement("svg",e({xmlns:"http://www.w3.org/2000/svg",enableBackground:"new 0 0 24 24",viewBox:"0 0 24 24",fill:"white",width:"18px",height:"18px"},t),n.createElement("g",null,n.createElement("path",{d:"M0,0h24v24H0V0z",fill:"none"}),n.createElement("path",{d:"M19.14,12.94c0.04-0.3,0.06-0.61,0.06-0.94c0-0.32-0.02-0.64-0.07-0.94l2.03-1.58c0.18-0.14,0.23-0.41,0.12-0.61 l-1.92-3.32c-0.12-0.22-0.37-0.29-0.59-0.22l-2.39,0.96c-0.5-0.38-1.03-0.7-1.62-0.94L14.4,2.81c-0.04-0.24-0.24-0.41-0.48-0.41 h-3.84c-0.24,0-0.43,0.17-0.47,0.41L9.25,5.35C8.66,5.59,8.12,5.92,7.63,6.29L5.24,5.33c-0.22-0.08-0.47,0-0.59,0.22L2.74,8.87 C2.62,9.08,2.66,9.34,2.86,9.48l2.03,1.58C4.84,11.36,4.8,11.69,4.8,12s0.02,0.64,0.07,0.94l-2.03,1.58 c-0.18,0.14-0.23,0.41-0.12,0.61l1.92,3.32c0.12,0.22,0.37,0.29,0.59,0.22l2.39-0.96c0.5,0.38,1.03,0.7,1.62,0.94l0.36,2.54 c0.05,0.24,0.24,0.41,0.48,0.41h3.84c0.24,0,0.44-0.17,0.47-0.41l0.36-2.54c0.59-0.24,1.13-0.56,1.62-0.94l2.39,0.96 c0.22,0.08,0.47,0,0.59-0.22l1.92-3.32c0.12-0.22,0.07-0.47-0.12-0.61L19.14,12.94z M12,15.6c-1.98,0-3.6-1.62-3.6-3.6 s1.62-3.6,3.6-3.6s3.6,1.62,3.6,3.6S13.98,15.6,12,15.6z"})))}function He(t){return n.createElement("svg",e({xmlns:"http://www.w3.org/2000/svg",enableBackground:"new 0 0 24 24",viewBox:"0 0 24 24",fill:"white",width:"18px",height:"18px"},t),n.createElement("g",null,n.createElement("rect",{fill:"none",height:24,width:24}),n.createElement("path",{d:"M14,12l-2,2l-2-2l2-2L14,12z M12,6l2.12,2.12l2.5-2.5L12,1L7.38,5.62l2.5,2.5L12,6z M6,12l2.12-2.12l-2.5-2.5L1,12 l4.62,4.62l2.5-2.5L6,12z M18,12l-2.12,2.12l2.5,2.5L23,12l-4.62-4.62l-2.5,2.5L18,12z M12,18l-2.12-2.12l-2.5,2.5L12,23l4.62-4.62 l-2.5-2.5L12,18z"})))}function Ue(t){return n.createElement("svg",e({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"white",width:"18px",height:"18px"},t),n.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}),n.createElement("path",{d:"M14 17H4v2h10v-2zm6-8H4v2h16V9zM4 15h16v-2H4v2zM4 5v2h16V5H4z"}))}function Ge(t){return n.createElement("svg",e({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"white",width:"18px",height:"18px"},t),n.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}),n.createElement("path",{d:"M13 13v8h8v-8h-8zM3 21h8v-8H3v8zM3 3v8h8V3H3zm13.66-1.31L11 7.34 16.66 13l5.66-5.66-5.66-5.65z"}))}function We(t){return n.createElement("svg",e({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"white",width:"18px",height:"18px"},t),n.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}),n.createElement("path",{d:"M3 13h2v-2H3v2zm0 4h2v-2H3v2zm0-8h2V7H3v2zm4 4h14v-2H7v2zm0 4h14v-2H7v2zM7 7v2h14V7H7z"}))}ze.defaultProps={fineAdjustIconX:"0",fineAdjustIconY:"0",openMargin:"0",toolTipText:"",isOpen:!1};const $e=s.div.attrs({className:"pointer-events-none grid grid-cols-2 gap-x-6 gap-y-5"})`
  position: fixed;
  bottom: ${({bottom:e})=>e};
  right: ${({right:e})=>e};
`,Fe=s.button.attrs((({isOpen:e,customStyles:t})=>({className:`rounded bg-white border border-gray-300 hover:border-gray-400 shadow-md hover:shadow-lg flex justify-start items-center px-4 py-4 transform transition\n    hover:-translate-y-0.5 focus:-translate-y-0.5 focus:border-0 focus:outline-none ring-2 ring-transparent ${e?"pointer-events-auto opacity-100 scale-100":"pointer-events-none opacity-0 scale-75"} ${t}`})))`
  transition-delay: ${({index:e})=>8*Math.pow(e,1.5)+"ms"};
`,Be=[{title:"OpMode View",view:x.OPMODE_VIEW,icon:n.createElement(Ge,{className:"w-6 h-6"}),customStyles:"focus:ring-red-600",iconBg:"bg-red-500"},{title:"Field View",view:x.FIELD_VIEW,icon:n.createElement(He,{className:"w-7 h-7 transform rotate-45"}),customStyles:"focus:ring-blue-600",iconBg:"bg-blue-500"},{title:"Graph View",view:x.GRAPH_VIEW,icon:n.createElement($,{className:"text-white w-6 h-6"}),customStyles:"focus:ring-green-600",iconBg:"bg-green-500"},{title:"Config View",view:x.CONFIG_VIEW,icon:n.createElement(Pe,{className:"w-6 h-6"}),customStyles:"focus:ring-orange-600",iconBg:"bg-orange-500"},{title:"Telemetry View",view:x.TELEMETRY_VIEW,icon:n.createElement(We,{className:"w-7 h-7"}),customStyles:"focus:ring-yellow-600",iconBg:"bg-yellow-500"},{title:"Logging View",view:x.LOGGING_VIEW,icon:n.createElement(Ue,{className:"w-6 h-6"}),customStyles:"focus:ring-ping-600",iconBg:"bg-pink-500"},{title:"Camera View",view:x.CAMERA_VIEW,icon:n.createElement(Ve,{className:"w-5 h-5"}),customStyles:"focus:ring-purple-600",iconBg:"bg-purple-500"}],qe=t=>n.createElement($e,e({},t),Be.map(((s,a)=>n.createElement(Fe,e(e({key:s.title},t),{index:a,customStyles:s.customStyles,onClick:()=>t.clickEvent(s.view),disabled:!t.isOpen}),n.createElement("div",{className:`w-8 h-8  rounded mr-3 flex-center ${s.iconBg}`},n.cloneElement(s.icon)),n.createElement("div",{className:"flex flex-col items-start"},n.createElement("h3",{className:"text-lg mt-0 leading-4 font-medium"},s.title))))));var je,Ye;function Ke(t){return n.createElement("svg",e({fill:"#fff",height:24,viewBox:"0 0 24 24",width:24,xmlns:"http://www.w3.org/2000/svg"},t),n.createElement("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z",fill:"currentColor"}),n.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}))}function Xe(t){return n.createElement("svg",e({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"white",width:"18px",height:"18px"},t),n.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}),n.createElement("path",{d:"M15 16h4v2h-4zm0-8h7v2h-7zm0 4h6v2h-6zM3 18c0 1.1.9 2 2 2h6c1.1 0 2-.9 2-2V8H3v10zM14 5h-3l-1-1H6L5 5H2v2h12z"}))}function Je(t){return n.createElement("svg",e({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"white",width:"18px",height:"18px"},t),n.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}),n.createElement("path",{d:"M0 0h24v24H0V0z",fill:"none"}),n.createElement("path",{fill:"currentColor",d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zm2.46-7.12l1.41-1.41L12 12.59l2.12-2.12 1.41 1.41L13.41 14l2.12 2.12-1.41 1.41L12 15.41l-2.12 2.12-1.41-1.41L10.59 14l-2.13-2.12zM15.5 4l-1-1h-5l-1 1H5v2h14V4z"}))}(Ye=je||(je={}))[Ye.INITIALIZE=0]="INITIALIZE",Ye[Ye.APPEND=1]="APPEND",Ye[Ye.UNDO=2]="UNDO",Ye[Ye.REDO=3]="REDO";function Ze(t){return n.createElement("svg",e({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"white",width:"18px",height:"18px"},t),n.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}),n.createElement("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm5 11H7v-2h10v2z"}))}function Qe(t){return n.createElement("svg",e({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"white",width:"18px",height:"18px"},t),n.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}),n.createElement("path",{d:"M7 11v2h10v-2H7zm5-9C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z"}))}const et=({columnIndex:e,rowIndex:t,style:s,data:a})=>{const i=a;return i.visibleColumns[e]?n.createElement("div",{className:"px-2 truncate "+(0===e?"text-neutral-gray-400":""),style:s},i.cellData[t][e]):null},tt=({header:e,data:t,columnsShowing:s})=>{const[a,i]=n.useState([]),[r,l]=n.useState(0),[o,c]=n.useState(!0),m=n.useRef(null);n.useEffect((()=>{i(new Array(e.length).fill(150))}),[e.length]),n.useEffect((()=>{0===t.length&&c(!0)}),[t.length]),n.useEffect((()=>{var e;null==(e=m.current)||e.resetAfterColumnIndex(0)}),[a,s]),n.useEffect((()=>{m.current&&o&&m.current.scrollToItem({rowIndex:t.length})}),[t.length,r,o]);const p=({scrollLeft:e,scrollTop:t,scrollUpdateWasRequested:n})=>{if(l(e),m.current){const e=30*m.current.props.rowCount-m.current.props.height-t;n||c(e<=15)}},g=a.map(((e,t)=>!1===(null!=s?s:[])[t]?0:e));return n.createElement("div",{className:"w-full h-full flex flex-col overflow-x-hidden"},n.createElement("div",{className:"mb-1",style:{width:(0===a.length?[0]:a).reduce(((e,t)=>e+t)),transform:`translateX(${-r}px)`}},e.map(((t,s)=>n.createElement("div",{key:t,className:"inline-flex flex-row relative pr-8 "+(0===g[s]?"hidden":""),style:{width:a[s],minWidth:"3em"}},n.createElement("span",{className:"font-semibold flex-grow truncate"},t),n.createElement(h,{onDrag:(n,{deltaX:s})=>((t,n)=>{const s=e.indexOf(t);if(-1===s)return;const r=[...a];r[s]=Math.max(50,r[s]+n),i(r)})(t,s)},n.createElement("div",{className:"cursor-col-resize hover:bg-gray-200 px-2 mr-2 rounded absolute right-1 hover:bg-opacity-75 transition-colors"},"â‹®")))))),n.createElement("div",{className:"flex-grow"},n.createElement(d,null,(({height:s,width:a})=>t.length>0?n.createElement(u,{ref:m,columnCount:e.length,columnWidth:e=>g[e],height:s,rowCount:t.length,rowHeight:()=>30,width:a,itemData:{cellData:t,visibleColumns:g.map((e=>0!==e))},onScroll:p},et):n.createElement("div",{style:{width:a,height:s},className:"flex-center text-center"},"Logs will be recorded as an opmode starts streaming telemetry data",n.createElement("br",null),"A CSV download will be available once the opmode is stopped")))))};function nt(e){return`${`0${e.getHours()}`.slice(-2)}:${`0${e.getMinutes()}`.slice(-2)}:${`0${e.getSeconds()}`.slice(-2)}.${`${e.getMilliseconds()}000`.slice(0,3)}`}function st(t){return n.createElement("svg",e({xmlns:"http://www.w3.org/2000/svg",enableBackground:"new 0 0 24 24",height:24,viewBox:"0 0 24 24",width:24},t),n.createElement("g",null,n.createElement("rect",{fill:"none",height:24,width:24})),n.createElement("g",null,n.createElement("path",{d:"M5,20h14v-2H5V20z M19,9h-4V3H9v6H5l7,7L19,9z"})))}function at(t){return n.createElement("svg",e({xmlns:"http://www.w3.org/2000/svg",enableBackground:"new 0 0 24 24",height:24,viewBox:"0 0 24 24",width:24},t),n.createElement("rect",{fill:"none",height:24,width:24}),n.createElement("path",{d:"M9,6.17V3h6v6h4l-3.59,3.59L9,6.17z M21.19,21.19L2.81,2.81L1.39,4.22L6.17,9H5l7,7l0.59-0.59L15.17,18H5v2h12.17l2.61,2.61 L21.19,21.19z"}))}function it(t){return n.createElement("svg",e({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"black",width:"18px",height:"18px"},t),n.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}),n.createElement("path",{d:"M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"}))}var rt,lt;(lt=rt||(rt={}))[lt.SET=0]="SET",lt[lt.APPEND=1]="APPEND",lt[lt.SET_KEY_SHOWING=2]="SET_KEY_SHOWING";const ot=(t,n)=>{switch(n.type){case 0:return n.payload;case 1:{const{store:e,keys:s,raw:a,keysShowing:i}=t,{timestamp:r,data:l,log:o}=n.payload,c={timestamp:r,log:o,data:new Array(s.length).fill(null)};for(const[t,n]of Object.entries(l))s.includes(t)||(s.push(t),i.push(!0)),c.data[s.indexOf(t)]=n;return e.push(c),a.push([nt(new Date(r)),...c.data]),{store:e,keys:s,raw:a,keysShowing:i}}case 2:{const s=[...t.keysShowing];return s[n.payload.index]=n.payload.value,e(e({},t),{keysShowing:s})}}},ct=({checked:e,onChange:t,children:s})=>n.createElement(p.Group,{as:"div",className:"flex items-center space-x-4 py-1 px-3"},n.createElement(p,{as:"button",checked:e,onChange:t,className:(e?"bg-indigo-600":"bg-gray-200")+" relative inline-flex flex-shrink-0 h-4 transition-colors duration-200 ease-in-out border-2 border-transparent rounded-full cursor-pointer w-7 focus:outline-none focus:shadow-outline"},(({checked:e})=>n.createElement("span",{className:(e?"translate-x-3":"translate-x-0")+" inline-block w-3 h-3 transition duration-200 ease-in-out transform bg-white rounded-full"}))),n.createElement(p.Label,{className:"ml-2"},s)),ht=({isDraggable:e=!1,isUnlocked:t=!1})=>{const{activeOpMode:s,activeOpModeStatus:a,opModeList:i}=o((e=>e.status)),r=o((e=>e.telemetry)),[l,c]=n.useReducer(ot,{store:[],keys:[],raw:[],keysShowing:[]}),[h,d]=n.useState(!1),[u,p]=n.useState(""),[g,f]=n.useState(!1),[v,E]=n.useState(!1),[w,y]=n.useState(!0),b=n.useRef(null),_=Te(.5,b),x=n.useRef(null),C=n.useRef(null);var O,k,R;O=x,k=()=>{v&&E(!1)},R=[C],n.useEffect((()=>{const e=e=>{!O.current||O.current.contains(e.target)||(null==R?void 0:R.every((t=>{var n;return null==(n=t.current)?void 0:n.contains(e.target)})))||k(e)};return document.addEventListener("mousedown",e),document.addEventListener("touchstart",e),()=>{document.removeEventListener("mousedown",e),document.removeEventListener("touchstart",e)}}),[O,k,R]),n.useEffect((()=>{0===(null==i?void 0:i.length)||"$Stop$Robot$"===s?d(!1):(a===ye||r.length>1)&&!h?(d(!0),T()):a===be&&d(!1)}),[s,a,h,i,r]),n.useEffect((()=>{a===ye&&p(null!=s?s:"")}),[s,a]),n.useEffect((()=>{h||0===l.store.length?f(!1):f(!0)}),[h,l.store.length]),n.useEffect((()=>{1===r.length&&0===r[0].timestamp||r.forEach((e=>{c({type:1,payload:e})}))}),[r]);const T=()=>{c({type:0,payload:{store:[],keys:[],raw:[],keysShowing:[]}})};return n.createElement(M,{isUnlocked:t},n.createElement("div",{className:"flex-center"},n.createElement(S,{isDraggable:e},"Logging"),n.createElement("div",{className:"flex items-center mr-3 space-x-1"},n.createElement("button",{className:"icon-btn w-8 h-8 "+(g?"":"border-gray-400"),onClick:()=>{if(!g)return;const e=[...l.store];e.sort(((e,t)=>e.timestamp-t.timestamp));const t=`${["time",...l.keys,"logs"]}\r\n${e.map((e=>`${nt(new Date(e.timestamp))},${[...e.data,...new Array(l.keys.length-e.data.length)].join(",")},"${e.log.join("\n")}"`)).join("\r\n")}`,n=new Date(e[0].timestamp),s=n.getFullYear(),a=`0${n.getMonth()}`.slice(-2),i=`0${n.getDay()}`.slice(-2),r=nt(n).replaceAll(":","_").split(".")[0];!function(e,t,n){const s=document.createElement("a");s.style.display="none",document.body.appendChild(s);const a=new Blob([e],{type:n}),i=window.URL.createObjectURL(a);s.href=i,s.download=t,s.click(),window.URL.revokeObjectURL(i),s.remove()}(t,`${u} ${s}-${a}-${i} ${r}.csv`,"text/csv")},ref:b},g?n.createElement(st,{className:"w-6 h-6"}):n.createElement(at,{className:"w-6 h-6 text-neutral-gray-400"}),n.createElement(Ie,{hoverRef:b,isShowing:_},0===l.store.length&&a!==ye?"No logs to download":a===ye&&"$Stop$Robot$"!==s?"Cannot download logs while OpMode is running":`Download logs for ${u}`)),n.createElement("div",{className:"relative inline-block"},n.createElement("button",{ref:C,className:"icon-btn w-8 h-8",onClick:()=>E(!v)},n.createElement(it,{className:"w-6 h-6"})),n.createElement(m,{show:v,enter:"transition ease-out duration-100",enterFrom:"transform opacity-0 scale-95",enterTo:"transform opacity-100 scale-100",leave:"transition ease-in duration-75",leaveFrom:"transform opacity-100 scale-100",leaveTo:"transform opacity-0 scale-95"},n.createElement("div",{ref:x,className:"absolute right-0 mt-2 py-2 origin-top-right bg-white border border-gray-200 rounded-md shadow-lg outline-none",style:{zIndex:99}},n.createElement("p",{className:"text-sm leading-5 border-b border-gray-100 pl-3 pb-1 mb-1 text-gray-500"},"Toggle Items"),n.createElement(ct,{checked:w,onChange:y},"Time"),[...l.keys].map(((e,t)=>n.createElement(ct,{key:e,checked:l.keysShowing[t],onChange:()=>c({type:2,payload:{index:t,value:!l.keysShowing[t]}})},e)))))))),n.createElement(N,null,n.createElement(tt,{header:0!==l.keys.length?["Time",...l.keys]:[],data:l.raw,columnsShowing:[w,...l.keysShowing]})))};function dt(e,t){if(e.length!==t.length)throw new Error("cannot compare arrays with different lengths");for(let n=0;n<e.length;n++){if(e[n]>t[n])return e;if(t[n]>e[n])return t}return e}const ut={[x.FIELD_VIEW]:n.createElement(ie,null),[x.GRAPH_VIEW]:n.createElement(Z,null),[x.CONFIG_VIEW]:n.createElement(ge,null),[x.TELEMETRY_VIEW]:n.createElement(fe,null),[x.CAMERA_VIEW]:n.createElement(Ee,null),[x.OPMODE_VIEW]:n.createElement(Se,null),[x.LOGGING_VIEW]:n.createElement(ht,null)},mt=g.WidthProvider(g),pt=s.div.attrs((({isLayoutLocked:e})=>({className:(e?"bg-white":"bg-gray-100")+" p-2 transition-colors"})))`
  position: relative;

  height: calc(100vh - 52px);

  overflow-x: hidden;
  overflow-y: scroll;
  padding-bottom: 1em;

  background-image: ${e=>e.isLayoutLocked?"":"radial-gradient(#94a3b8 calc((0.5rem + 10px) - 17px), transparent 0)"};
  background-size: ${e=>`${e.bgGridSize}px  ${e.bgGridSize}px`};
  background-position: ${"calc(0.5rem + 10px) calc(0.5rem + 10px - 5px)"};
`,gt=730,ft=1200,vt=[{id:a(),view:x.FIELD_VIEW,layout:{x:0,y:0,w:4,h:9,minW:3,isDraggable:!0,isResizable:!0}},{id:a(),view:x.GRAPH_VIEW,layout:{x:4,y:0,w:4,h:9,minW:3,isDraggable:!0,isResizable:!0}},{id:a(),view:x.CONFIG_VIEW,layout:{x:8,y:0,w:4,h:7,minW:3,isDraggable:!0,isResizable:!0}},{id:a(),view:x.TELEMETRY_VIEW,layout:{x:8,y:7,w:4,h:2,minW:3,isDraggable:!0,isResizable:!0}}],Et=[{id:a(),view:x.FIELD_VIEW,layout:{x:0,y:0,w:4,h:13,minW:3,isDraggable:!0,isResizable:!0}},{id:a(),view:x.GRAPH_VIEW,layout:{x:4,y:0,w:4,h:13,minW:3,isDraggable:!0,isResizable:!0}},{id:a(),view:x.CONFIG_VIEW,layout:{x:8,y:0,w:4,h:11,minW:3,isDraggable:!0,isResizable:!0}},{id:a(),view:x.TELEMETRY_VIEW,layout:{x:8,y:11,w:4,h:2,minW:3,isDraggable:!0,isResizable:!0}}],wt=[{id:a(),view:x.FIELD_VIEW,layout:{x:0,y:0,w:4,h:18,minW:3,isDraggable:!0,isResizable:!0}},{id:a(),view:x.GRAPH_VIEW,layout:{x:4,y:0,w:4,h:18,minW:3,isDraggable:!0,isResizable:!0}},{id:a(),view:x.CONFIG_VIEW,layout:{x:8,y:0,w:4,h:14,minW:3,isDraggable:!0,isResizable:!0}},{id:a(),view:x.TELEMETRY_VIEW,layout:{x:8,y:11,w:4,h:4,minW:3,isDraggable:!0,isResizable:!0}}];function yt(){const t=n.useRef(null),s=n.useRef(null),[r,l]=n.useState(!0),[o,c]=n.useState(!1),[h,d]=n.useState(!1),[u,m]=n.useState(40),[p,{initialize:g,append:f,undo:v,redo:E}]=function(t){const[{history:s,currentHistoryPosition:a},r]=n.useReducer(((t,n)=>{switch(n.type){case 0:return{history:[n.payload],currentHistoryPosition:0};case 1:return 0!==t.history.length&&i.isEqual(t.history[t.currentHistoryPosition],n.payload)?t:{history:[...t.history.slice(0,t.currentHistoryPosition+1),n.payload],currentHistoryPosition:t.currentHistoryPosition+1};case 2:return t.currentHistoryPosition<=0?t:e(e({},t),{currentHistoryPosition:t.currentHistoryPosition-1});case 3:return t.currentHistoryPosition>=t.history.length-1?t:e(e({},t),{currentHistoryPosition:t.currentHistoryPosition+1})}}),{history:[t],currentHistoryPosition:0}),l=n.useMemo((()=>e=>r({type:0,payload:e})),[r]),o=n.useMemo((()=>e=>r({type:1,payload:e})),[r]),c=n.useMemo((()=>()=>r({type:2})),[r]),h=n.useMemo((()=>()=>r({type:3})),[r]);return[s[a],{initialize:l,append:o,undo:c,redo:h}]}([]),w=function(e){const[t,s]=n.useState(!1),a=n.useRef(null),[i]=n.useState((()=>{var t,n,s;const a=document.createElement("div");return a.style.position="fixed",e.top&&(a.style.top=e.top),e.bottom&&(a.style.bottom=null!=(t=e.bottom)?t:""),e.left&&(a.style.left=null!=(n=e.bottom)?n:""),e.right&&(a.style.right=null!=(s=e.right)?s:""),a.style.width=e.width,a.style.height=e.height,a.style.pointerEvents="none",a}));return n.useEffect((()=>{const t=t=>{var n;if(t.clientX>i.offsetLeft&&t.clientY>i.offsetTop&&t.clientX<i.offsetLeft+i.clientWidth&&t.clientY<i.offsetTop+i.clientHeight){const t=null!=(n=e.timeout)?n:5e3;null!==a.current&&clearInterval(a.current),a.current=setTimeout((()=>s(!0)),t),s(!1)}};return document.body.appendChild(i),document.body.addEventListener("mousemove",t),()=>{document.body.removeChild(i),document.body.removeEventListener("mousemove",t),null!==a.current&&clearTimeout(a.current)}}),[i,e.timeout]),t}({bottom:"0",right:"0",width:"14em",height:"13em"});n.useEffect((()=>{const e=new ResizeObserver((e=>{if(s.current)for(const t of e)if(t.target===s.current){const e=s.current.clientWidth-20;m(e/(3*Math.floor(e/300)+1)/3)}}));return null!==s.current&&e.observe(s.current),()=>{e.disconnect()}}),[]),n.useEffect((()=>{const e=window.localStorage.getItem("configurableLayoutStorage"),n=(()=>{var n;if(null!==e)return JSON.parse(e);{const e=null==(n=t.current)?void 0:n.clientHeight;return e?e>ft?wt:e>gt?Et:vt:vt}})();n.forEach((e=>{e.layout.isResizable=!1,e.layout.isDraggable=!1})),g(n)}),[g]),n.useEffect((()=>{const e=e=>{r||navigator.platform.indexOf("Mac")>-1&&(e.metaKey&&"z"===e.key?e.shiftKey?E():v():e.ctrlKey&&"z"===e.key?v():e.ctrlKey&&"y"===e.key&&E())};return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}}),[r,v,E]),n.useEffect((()=>{window.localStorage.setItem("configurableLayoutStorage",JSON.stringify([...p]))}),[p]);return n.createElement(pt,{ref:t,isLayoutLocked:r,bgGridSize:u},0===p.length&&n.createElement("div",{className:"text-center mt-16 p-12 transition-colors "+(r?"bg-white":"bg-gray-100")},n.createElement("h3",{className:"text-2xl"},"Your custom layout is empty!"),n.createElement("p",{className:"text-gray-600 mt-3"},"Press the floating pencil icon near the bottom right",n.createElement("br",null),"and then click the green plus button to create your own layouts!")),n.createElement("div",{ref:s},n.createElement(mt,{className:"layout",cols:12,resizeHandles:["se"],draggableHandle:".grab-handle",compactType:null,rowHeight:r?70:60,layout:p.map((t=>e({i:t.id},t.layout))),onLayoutChange:t=>{const n=p.map((n=>{var s,a,i;const r=t.find((e=>e.i===n.id));if(null!=r){const t={x:r.x,y:r.y,w:r.w,h:r.h,minW:null!=(s=r.minW)?s:3,isDraggable:null==(a=r.isDraggable)||a,isResizable:null==(i=r.isResizable)||i};n=e(e({},n),{layout:t})}return n}));f(n)},margin:r?[0,0]:[10,10]},p.map((e=>n.createElement("div",{key:e.id},n.cloneElement(ut[e.view],{isDraggable:e.layout.isDraggable,isUnlocked:!r}),n.createElement("div",{className:"absolute top-0 left-0 w-full h-full bg-yellow-300 bg-opacity-50 flex-center rounded transition "+(o?"pointer-events opacity-100":"pointer-events-none opacity-0")},n.createElement("button",{className:"p-4 border-4 border-yellow-600 rounded-full bg-opacity-50 opacity-50 focus:outline-none focus:ring focus:ring-yellow-800",onClick:()=>{var t;t=e.id,f(p.filter((e=>e.id!==t)))},disabled:!o},n.createElement(Je,{className:"text-yellow-600 w-20 h-20"})))))))),n.createElement(Re,{width:"4em",height:"4em",bottom:"2em",right:"3.5em",isOpen:!r,isShowing:!(w&&r),clickEvent:()=>{const t=!r;l(t),f(p.map((n=>(n.layout=e(e({},n.layout),{isResizable:!t,isDraggable:!t}),n)))),t&&(d(!1),c(!1))},icon:r?"/dash/assets/create.34997070.svg":"/dash/assets/lock.505d8c02.svg",customClassName:""+(r?"bg-red-500 focus:ring-4 focus:ring-red-600 shadow-red-500-md-prominent hover:shadow-red-500-lg-prominent":"bg-gray-500 focus:ring-4 focus:ring-gray-600 shadow-gray-900-md-prominent hover:shadow-gray-900-lg-prominent")},n.createElement(ze,{customClass:"w-12 h-12 bg-green-500 border border-green-600 shadow-green-500-md-prominent hover:shadow-green-500-lg-prominent focus:ring focus:ring-green-600",angle:-80*Math.PI/180,openMargin:"5em",fineAdjustIconX:"2%",fineAdjustIconY:"2%",toolTipText:"Add Item",clickEvent:()=>d(!h)},n.createElement(Ke,{className:"text-white w-6 h-6"})),n.createElement(ze,{customClass:"w-12 h-12 border shadow-orange-500-md-prominent hover:shadow-orange-500-lg-prominent focus:ring "+(o?"bg-orange-500 border-yellow-600 focus:ring-yellow-300":"bg-yellow-500 border-yellow-600 focus:ring-orange-300"),angle:-135*Math.PI/180,openMargin:"5em",fineAdjustIconX:"0",fineAdjustIconY:"0",toolTipText:"Delete Item",clickEvent:()=>c(!o)},o?n.createElement(Qe,{className:"w-5 h-5"}):n.createElement(Ze,{className:"w-5 h-5"})),n.createElement(ze,{customClass:"w-12 h-12 bg-indigo-500 border border-indigo-600 shadow-indigo-500-md-prominent hover:shadow-indigo-500-lg-prominent focus:ring focus:ring-indigo-300",angle:170*Math.PI/180,openMargin:"5em",fineAdjustIconX:"8%",fineAdjustIconY:"-2%",toolTipText:"Clear Layout",clickEvent:()=>f([])},n.createElement(Xe,{className:"w-5 h-5"}))),n.createElement(qe,{isOpen:h,bottom:"13em",right:"1.5em",clickEvent:e=>{let[t,n]=p.map((e=>[e.layout.y+e.layout.h,e.layout.x+e.layout.w])).reduce(dt,[0,0]);n+4>12&&(n=0,t+=4);const s=p.filter((e=>function([e,t],[n,s]){return Math.max(e,n)<Math.min(t,s)}([n,n+4],[e.layout.x,e.layout.x+e.layout.w]))).map((e=>e.layout.y+e.layout.h)).reduce(((e,t)=>Math.max(e,t)),0),i=Math.max(t-4,s);f([...p,{id:a(),view:e,layout:{x:n,y:i,w:4,h:4,minW:3,isDraggable:!r,isResizable:!r}}])}}))}const bt={DEFAULT:"DEFAULT",FIELD:"FIELD",GRAPH:"GRAPH",ORIGINAL:"ORIGINAL",CONFIGURABLE:"CONFIGURABLE"},_t={[bt.DEFAULT]:{name:"Default",content:n.createElement(b,{gridTemplate:"220px calc(60% - 220px) 40% / 30% 40% 30%"},n.createElement(_,{row:"1 / span 1",col:1},n.createElement(Se,null)),n.createElement(_,{row:"2 / span 2",col:1},n.createElement(Ee,null)),n.createElement(_,{row:"1 / span 3",col:2},n.createElement(Z,null)),n.createElement(_,{row:"1 / span 2",col:3},n.createElement(ge,null)),n.createElement(_,{row:3,col:3},n.createElement(fe,null)))},[bt.FIELD]:{name:"Field",content:n.createElement(b,{gridTemplate:"220px calc(60% - 220px) 40% / 30% 40% 30%"},n.createElement(_,{row:"1 / span 1",col:1},n.createElement(Se,null)),n.createElement(_,{row:"2 / span 2",col:1},n.createElement(ie,null)),n.createElement(_,{row:"1 / span 3",col:2},n.createElement(Z,null)),n.createElement(_,{row:"1 / span 2",col:3},n.createElement(ge,null)),n.createElement(_,{row:3,col:3},n.createElement(fe,null)))},[bt.GRAPH]:{name:"Graph",content:n.createElement(b,{gridTemplate:"100% / 50% 50%"},n.createElement(_,{row:1,col:1},n.createElement(Z,null)),n.createElement(_,{row:1,col:2},n.createElement(Z,null)))},[bt.ORIGINAL]:{name:"Original",content:n.createElement(b,{gridTemplate:"60% 40% / 65% 35%"},n.createElement(_,{row:"1 / span 2",col:1},n.createElement(Z,null)),n.createElement(_,{row:1,col:2},n.createElement(ge,null)),n.createElement(_,{row:2,col:2},n.createElement(fe,null)))},[bt.CONFIGURABLE]:{name:"Custom",content:n.createElement(yt,null)}};var xt=Object.freeze(e(e({},bt),{getName:e=>_t[e].name,getContent:e=>{var t,n;return null!=(n=null==(t=_t[e])?void 0:t.content)?n:_t[bt.DEFAULT].content}}));const Ct=(e,t)=>({type:"CONNECT",host:e,port:t}),Mt=e=>t=>{t({type:"RECEIVE_CONNECTION_STATUS",isConnected:e}),e||t({type:"RECEIVE_OP_MODE_LIST",opModeList:[]})},St=e=>({type:"RECEIVE_LAYOUT_PRESET",preset:e});function Nt(t){return n.createElement("svg",e({fill:"#FFFFFF",height:48,viewBox:"0 0 24 24",width:48,xmlns:"http://www.w3.org/2000/svg"},t),n.createElement("path",{d:"M12.01 21.49L23.64 7c-.45-.34-4.93-4-11.64-4C5.28 3 .81 6.66.36 7l11.63 14.49.01.01.01-.01z",fillOpacity:.3}),n.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}),n.createElement("path",{d:"M3.53 10.95l8.46 10.54.01.01.01-.01 8.46-10.54C20.04 10.62 16.81 8 12 8c-4.81 0-8.04 2.62-8.47 2.95z"}))}function Ot(t){return n.createElement("svg",e({fill:"#FFFFFF",height:48,viewBox:"0 0 24 24",width:48,xmlns:"http://www.w3.org/2000/svg"},t),n.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}),n.createElement("path",{d:"M23.64 7c-.45-.34-4.93-4-11.64-4-1.5 0-2.89.19-4.15.48L18.18 13.8 23.64 7zm-6.6 8.22L3.27 1.44 2 2.72l2.05 2.06C1.91 5.76.59 6.82.36 7l11.63 14.49.01.01.01-.01 3.9-4.86 3.32 3.32 1.27-1.27-3.46-3.46z"}))}class kt extends n.Component{componentDidMount(){this.props.dispatch(Ct(window.location.hostname,"8000")),this.props.dispatch({type:"GET_LAYOUT_PRESET"})}componentWillUnmount(){this.props.dispatch({type:"DISCONNECT"})}render(){return n.createElement("div",{className:"flex flex-col",style:{width:"100vw",height:"100vh"}},n.createElement("header",{className:"flex justify-between items-center bg-blue-600 px-3 py-1 text-white"},n.createElement("h1",{className:"text-2xl font-medium"},"FTC Dashboard"),n.createElement("div",{className:"flex-center"},n.createElement("select",{className:"text-black text-sm rounded mx-2 py-1 bg-blue-100 border-blue-300 focus:border-blue-100 focus:ring-2 focus:ring-white focus:ring-opacity-40",value:this.props.layoutPreset,onChange:e=>this.props.dispatch({type:"SAVE_LAYOUT_PRESET",preset:e.target.value})},Object.keys(xt).filter((e=>"string"==typeof xt[e])).map((e=>n.createElement("option",{key:e,value:e},xt.getName(e))))),this.props.isConnected&&n.createElement("p",{className:"mx-2",style:{width:"60px",textAlign:"right"}},this.props.pingTime,"ms"),this.props.isConnected?n.createElement(Nt,{className:"ml-4 w-10 h-10"}):n.createElement(Ot,{className:"ml-4 w-10 h-10"}))),xt.getContent(this.props.layoutPreset))}}kt.propTypes={isConnected:t.bool.isRequired,pingTime:t.number.isRequired,layoutPreset:t.oneOf(Object.keys(xt)).isRequired,dispatch:t.func.isRequired};var Rt=r((({socket:e,settings:t})=>({isConnected:e.isConnected,pingTime:e.pingTime,layoutPreset:t.layoutPreset})))(kt);const Tt=e=>({type:"GAMEPAD_CONNECTED",user:e}),Lt=e=>({type:"GAMEPAD_DISCONNECTED",user:e});let It,Dt,At;const zt=(e,t)=>n=>{const s=Date.now();(!i.isEqual(It,e)||!i.isEqual(Dt,t)||s-At<150)&&(n(((e,t)=>({type:"RECEIVE_GAMEPAD_STATE",gamepad1:e,gamepad2:t}))(e,t)),It=e,Dt=t,At=s)},Vt={LOGITECH_DUAL_ACTION:"LOGITECH_DUAL_ACTION",XBOX_360:"XBOX_360",SONY_DUALSHOCK_4:"SONY_DUALSHOCK_4",UNKNOWN:"UNKNOWN"};var Pt=e(e({},Vt),{getFromGamepad:e=>-1!==e.id.search("Logitech Dual Action")?Vt.LOGITECH_DUAL_ACTION:-1!==e.id.search("Xbox 360")?Vt.XBOX_360:-1!==e.id.search("054c")&&-1!==e.id.search(new RegExp("09cc|05c4","i"))||-1!==e.id.search(new RegExp("(?=.*7545)(?=.*104)","i"))?Vt.SONY_DUALSHOCK_4:Vt.UNKNOWN,getJoystickDeadzone:e=>{switch(e){case Vt.LOGITECH_DUAL_ACTION:return.06;case Vt.XBOX_360:return.15;case Vt.SONY_DUALSHOCK_4:return.04;default:return.2}},isSupported:e=>e!==Vt.UNKNOWN});const Ht=(e,t,n,s,a)=>s+(e-t)*(a-s)/(n-t),Ut=(e,t=.2,n=1)=>-t<e&&e<t?0:e>n||e<-n?n:e>0?Ht(e,t,n,0,n):Ht(e,-t,-n,0,-n),Gt={left_stick_x:0,left_stick_y:0,right_stick_x:0,right_stick_y:0,dpad_up:!1,dpad_down:!1,dpad_left:!1,dpad_right:!1,a:!1,b:!1,x:!1,y:!1,guide:!1,start:!1,back:!1,left_bumper:!1,right_bumper:!1,left_stick_button:!1,right_stick_button:!1,left_trigger:0,right_trigger:0},Wt=e=>{const t=Pt.getFromGamepad(e);if(!Pt.isSupported(t))throw new Error("Unable to extract state from unsupported gamepad.");switch(t){case Pt.LOGITECH_DUAL_ACTION:return{left_stick_x:Ut(-e.axes[1]),left_stick_y:Ut(e.axes[2]),right_stick_x:Ut(-e.axes[3]),right_stick_y:Ut(e.axes[4]),dpad_up:e.buttons[12].pressed,dpad_down:e.buttons[13].pressed,dpad_left:e.buttons[14].pressed,dpad_right:e.buttons[15].pressed,a:e.buttons[1].pressed,b:e.buttons[2].pressed,x:e.buttons[0].pressed,y:e.buttons[3].pressed,guide:!1,start:e.buttons[9].pressed,back:e.buttons[8].pressed,left_bumper:e.buttons[4].pressed,right_bumper:e.buttons[5].pressed,left_stick_button:e.buttons[10].pressed,right_stick_button:e.buttons[11].pressed,left_trigger:e.buttons[6].value,right_trigger:e.buttons[7].value};case Pt.XBOX_360:return{left_stick_x:Ut(e.axes[0]),left_stick_y:Ut(e.axes[1]),right_stick_x:Ut(e.axes[3]),right_stick_y:Ut(e.axes[4]),dpad_up:e.buttons[12].pressed,dpad_down:e.buttons[13].pressed,dpad_left:e.buttons[14].pressed,dpad_right:e.buttons[15].pressed,a:e.buttons[0].pressed,b:e.buttons[1].pressed,x:e.buttons[2].pressed,y:e.buttons[3].pressed,guide:!1,start:e.buttons[9].pressed,back:e.buttons[8].pressed,left_bumper:e.buttons[4].pressed,right_bumper:e.buttons[5].pressed,left_stick_button:e.buttons[10].pressed,right_stick_button:e.buttons[11].pressed,left_trigger:e.buttons[6].value,right_trigger:e.buttons[7].value};case Pt.SONY_DUALSHOCK_4:return{left_stick_x:Ut(e.axes[0]),left_stick_y:Ut(e.axes[1]),right_stick_x:Ut(e.axes[2]),right_stick_y:Ut(e.axes[3]),dpad_up:e.buttons[12].pressed,dpad_down:e.buttons[13].pressed,dpad_left:e.buttons[14].pressed,dpad_right:e.buttons[15].pressed,a:e.buttons[0].pressed,b:e.buttons[1].pressed,x:e.buttons[2].pressed,y:e.buttons[3].pressed,guide:e.buttons[16].pressed,start:e.buttons[9].pressed,back:e.buttons[8].pressed,left_bumper:e.buttons[4].pressed,right_bumper:e.buttons[5].pressed,left_stick_button:e.buttons[10].pressed,right_stick_button:e.buttons[11].pressed,left_trigger:e.buttons[6].value,right_trigger:e.buttons[7].value,touchpad:e.buttons[17].pressed};default:throw new Error(`Unable to handle support gamepad of type ${t}`)}};let $t=-1,Ft=-1;const Bt=e=>(window.addEventListener("gamepaddisconnected",(t=>{const{gamepad:n}=t;$t===n.index?(e.dispatch(Lt($t)),$t=-1):Ft===n.index&&(e.dispatch(Lt(Ft)),Ft=-1)})),function t(){const n=navigator.getGamepads();if(0!==n.length){for(const t of navigator.getGamepads()){if(null===t||!t.connected)continue;const s=Pt.getFromGamepad(t);if(!Pt.isSupported(s))continue;const a=Wt(t);let i,r;if(a.start&&a.a?($t=t.index,e.dispatch(Tt(1)),Ft===$t&&(e.dispatch(Lt(2)),Ft=-1)):a.start&&a.b&&(Ft=t.index,e.dispatch(Tt(2)),$t===Ft&&(e.dispatch(Lt(1)),$t=-1)),-1!==$t){const e=n[$t];i=e?Wt(e):Gt}else i=Gt;if(-1!==Ft){const e=n[Ft];r=e?Wt(e):Gt}else r=Gt;e.dispatch(zt(i,r))}requestAnimationFrame(t)}else setTimeout(t,500)}(),e=>t=>e(t));let qt,jt;const Yt=()=>(e,t)=>{const{isConnected:n}=t().socket;n&&(jt=Date.now(),e({type:"GET_ROBOT_STATUS"}),setTimeout((()=>{e(Yt())}),1e3))},Kt=e=>t=>n=>{switch(n.type){case"CONNECT":qt=new WebSocket(`ws://${n.host}:${n.port}`),qt.onmessage=t=>{const n=JSON.parse(t.data);e.dispatch(n)},qt.onopen=()=>{e.dispatch(Mt(!0)),e.dispatch(Yt())},qt.onclose=()=>{e.dispatch(Mt(!1)),setTimeout((()=>e.dispatch(Ct(n.host,n.port))),500)};break;case"DISCONNECT":qt.close();break;case"RECEIVE_ROBOT_STATUS":{const s=Date.now()-jt;e.dispatch((e=>({type:"RECEIVE_PING_TIME",pingTime:e}))(s)),t(n);break}case"RECEIVE_GAMEPAD_STATE":case"GET_ROBOT_STATUS":case"SAVE_CONFIG":case"GET_CONFIG":case"INIT_OP_MODE":case"START_OP_MODE":case"STOP_OP_MODE":{const{isConnected:s}=e.getState().socket;s&&qt.send(JSON.stringify(n)),t(n);break}default:t(n)}},Xt=e=>t=>n=>{switch(n.type){case"GET_LAYOUT_PRESET":{const t=localStorage.getItem("layoutPreset")||xt.DEFAULT;e.dispatch(St(t));break}case"SAVE_LAYOUT_PRESET":localStorage.setItem("layoutPreset",n.preset),e.dispatch(St(n.preset));break;default:t(n)}},Jt=[{timestamp:0,data:{},log:[],fieldOverlay:{ops:[]}}],Zt={isConnected:!1,pingTime:0},Qt=(e,t)=>{if(t.__type===oe.CUSTOM){const n={__type:oe.CUSTOM,__value:{}};for(const s of Object.keys(t.__value)){let a={};a="object"==typeof e.__value?e.__value[s]:{},n.__value[s]=Qt(a,t.__value[s])}return n}return(e=e).__modified?{__type:t.__type,__value:t.__value,__newValue:e.__newValue,__valid:e.__valid,__modified:!0,__enumClass:t.__enumClass,__enumValues:t.__enumValues}:{__type:t.__type,__value:t.__value,__newValue:t.__value,__valid:!0,__modified:!1,__enumClass:t.__enumClass,__enumValues:t.__enumValues}},en=(e,t,n)=>{if(e.__type===oe.CUSTOM){const s={__type:oe.CUSTOM,__value:{}};for(const a of Object.keys(e.__value))"object"==typeof t.__value&&a in t.__value?s.__value[a]=en(e.__value[a],t.__value[a],n):s.__value[a]=i.cloneDeep(e.__value[a]);return s}{let s=!0;return"object"!=typeof t.__value&&(s=t.__valid),{__type:e.__type,__value:e.__value,__newValue:t.__value,__valid:s,__modified:n,__enumClass:e.__enumClass,__enumValues:e.__enumValues}}},tn=e=>{if(e.__type===oe.CUSTOM){const t={__type:oe.CUSTOM,__value:{}};for(const n of Object.keys(e.__value))t.__value[n]=tn(e.__value[n]);return t}return{__type:e.__type,__value:e.__value,__newValue:e.__value,__valid:!0,__modified:!1,__enumClass:e.__enumClass,__enumValues:e.__enumValues}},nn={configRoot:{}},sn={available:!1,activeOpMode:"",activeOpModeStatus:be,opModeList:[],warningMessage:"",errorMessage:""},an={imageStr:""},rn={layoutPreset:xt.DEFAULT},ln={gamepad1Connected:!1,gamepad2Connected:!1},on=f({telemetry:(e=Jt,t)=>{switch(t.type){case"RECEIVE_TELEMETRY":return t.telemetry;default:return e}},socket:(t=Zt,n)=>{switch(n.type){case"RECEIVE_PING_TIME":return e(e({},t),{pingTime:n.pingTime});case"RECEIVE_CONNECTION_STATUS":return e(e({},t),{isConnected:n.isConnected});default:return t}},config:(t=nn,n)=>{switch(n.type){case"RECEIVE_CONFIG":return e(e({},t),{configRoot:Qt(t.configRoot,n.configRoot)});case"UPDATE_CONFIG":return e(e({},t),{configRoot:en(t.configRoot,n.configDiff,!0)});case"SAVE_CONFIG":return e(e({},t),{configRoot:en(t.configRoot,n.configDiff,!1)});case"REFRESH_CONFIG":return e(e({},t),{configRoot:tn(t.configRoot)});default:return t}},status:(t=sn,n)=>{switch(n.type){case"RECEIVE_ROBOT_STATUS":return e(e({},t),n.status);case"RECEIVE_OP_MODE_LIST":return e(e({},t),{opModeList:n.opModeList});default:return t}},camera:(t=an,n)=>{switch(n.type){case"RECEIVE_IMAGE":return e(e({},t),{imageStr:n.imageString});default:return t}},settings:(t=rn,n)=>{switch(n.type){case"RECEIVE_LAYOUT_PRESET":return e(e({},t),{layoutPreset:n.preset});default:return t}},gamepad:(t=ln,n)=>{switch(n.type){case"GAMEPAD_CONNECTED":return 1===n.user?e(e({},t),{gamepad1Connected:!0}):e(e({},t),{gamepad2Connected:!0});case"GAMEPAD_DISCONNECTED":return 1===n.user?e(e({},t),{gamepad1Connected:!1}):e(e({},t),{gamepad2Connected:!1});default:return t}}});const cn=v(on,E(w,Bt,Kt,Xt));c.render(n.createElement(y,{store:cn},n.createElement(Rt,null)),document.getElementById("root"));
